<!DOCTYPE html>
<html class="no-js ">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>
    Drupal as the CMS for a restful API for an iPhone App.
  </title>
  <meta name="description" content="Overview of how we used Drupal as the CMS to for an iOS app">
  <meta name="keywords" content="Drupal, RESTful, iOS, services, CMS">
  <meta name="author" content="Adam Davis">
  <meta name="viewport" content="width=device-width">
  <meta property="og:title" content="Drupal as the CMS for a restful API for an iPhone App." />
  <meta property="og:url" content="http://localhost:8080//notes/drupal-rest-service-iphone-app/" />
  <meta property="og:description" content="Overview of how we used Drupal as the CMS to for an iOS app" />
  <meta property="og:site_name" content="admataz. Web apps and bespoke web development, London UK" />
  <meta property="og:image" content="http://localhost:8080/assets/images/admataz_front.png" />
  <link rel="alternate" title="admataz. Web apps and bespoke web development, London UK" type="application/json"
    href="http://localhost:8080/feed.json" />
  <link rel="alternate" type="application/atom+xml" title="Blog" href="http://localhost:8080/feed.xml?type=blog" />
  
  <link href="/assets/favicon.png" rel="icon" type="image/png">

  <link rel="stylesheet" href="/main.css" />

  <script type="text/javascript" src="/assets/scripts/admataz-blocks.js"></script>
</head>

<body>
  <div id="top-bar">
    <div class="logo">
      <p><a href="/"><img src="/assets/images/admataz-logo-black.svg" alt="admataz logo"></a></p>

    </div>
    <div class="main-nav">
      <ul>
<li><span class="code"><a href="/code">Code</a></span></li>
<li><span class="tools"><a href="/tools">Tools</a></span></li>
<li><span class="viz"><a href="/viz">dataviz</a></span><!-- - <span class="games">[Games](/games)</span> --></li>
</ul>

    </div>
  </div>


  <div id="page-content-container">
    <div id="content-main">
      <admataz-blocks scale="42" definedylimit="12" gapfrequency="0.7" randomness="10">
        <div class="body-content article-content">

  <div class="page-main ">
    <h1>Drupal as the CMS for a restful API for an iPhone App.</h1>
    <div class="datestamp">11 June 2013</div>
    <div class="intro">
      Overview of how we used Drupal as the CMS to for an iOS app
    </div>
    
    <div class="page-body">
    <p>For a recent contract the client stipulated Drupal as the CMS to support the web services for their iPhone App. Our advice was to go for a lighter framework that better supports web services and gives better control over things like http headers and the json output.  But sometimes you just have to suck it in and do the best you can with what the client wants...</p>
<p>We made our start with a Drupal 7 minimal install profile and used a number of contributed modules to provide the bulk of the required functionality, with some enhancements via custom coded modules. </p>
<h2 id="views-content-based-restful-server">Views content based RESTful server</h2>
<p>These are the core and contributed modules we used to set up the base RESTful service:</p>
<ul>
<li><code>ctools</code> - a low level module with an tools required by other modules</li>
<li><code>entity</code> - provides and API for defining and managing custom Entities </li>
<li><code>entityreference</code> - provides the ability to build relationships between entities </li>
<li><code>features</code> - allows us to package configurations and dependencies</li>
<li><code>field_ui</code> - core module for adding fields to entities</li>
<li><code>file</code> - core module for allowing uploads to entities</li>
<li><code>image</code> - core module for managing image content</li>
<li><code>inline_entity_form</code> - interface for adding related entities within the &#39;parent&#39; entity edit form</li>
<li><code>list</code> - core field input module</li>
<li><code>module_filter</code> - interface enhancement for managing modules</li>
<li><code>number</code> - core input field</li>
<li><code>options</code> - core input field</li>
<li><code>rest_server</code> - provide a RESTful server as part of services</li>
<li><code>services</code> - module to manage web services endpoints and output formats</li>
<li><code>services_entity</code> - module to make custom entities available to services</li>
<li><code>services_views</code> - module to make views available to services</li>
<li><code>taxonomy</code> - core module</li>
<li><code>views</code> - essentially a query builder with some output formatting</li>
<li><code>views_ui</code> - interface for managing views</li>
</ul>
<p>The data output for the services endpoint in this application is defined in queries built using Views.</p>
<h2 id="drupalisms">Drupalisms</h2>
<p>Using these tools has some drawbacks. If you&#39;re used to building RESTful services closer to the metal, may come as a shock. </p>
<ul>
<li>all returned values are strings. The iOS devs hate it when their IDs are not numeric. We eventually did some post-processing to the JSON as it really did improve client side performance. </li>
<li>strings are escaped for HTML output - so entities like ampersands and special chars are represented as XML friendly (e.g. <code>&amp;amp;</code> for &amp; and <code>&amp;#039;</code> for apostrophes). This  reflects what Drupal considers normal output. </li>
<li>empty properties are sometimes presented as an empty array, even if the expected non-empty property should be a string (or stringified number). Words fail me on this one.</li>
<li>related content types are problematic to embed - so normal &#39;hasmany&#39; or &#39;belongsto&#39; relationships one can get easily from an MVC framework are not available. This potentially means more queries to the server than desired, which can be problematic for low bandwidth situations on mobile.</li>
<li>last modified is a unix timestamp - can&#39;t seem to be able to format the output as a date</li>
</ul>
<h2 id="dont-try-this-at-home">Don&#39;t try this at home.</h2>
<p>I wouldn&#39;t recommend using Drupal to build web services. We took a contributed module approach with the hope that this would provide more stability in handover to the client. I&#39;m still not sure about this - I think we could have achieved better control if we had done less &#39;the Drupal way&#39; and trusted our code query the database and output the raw json, without dressing it up Views and the CMS interface, and introducing a level of cruft to the output. If you have the option to use other PHP tools, or Ruby on Rails, or something like Restify on node.js - I would recommend it. </p>

    </div>
  </div>



</div> dd
      </admataz-blocks>
    </div>

    <div class="main-nav bottom">
      <ul>
<li><span class="code"><a href="/code">Code</a></span></li>
<li><span class="tools"><a href="/tools">Tools</a></span></li>
<li><span class="viz"><a href="/viz">dataviz</a></span><!-- - <span class="games">[Games](/games)</span> --></li>
</ul>

    </div>

    <div id="footer-bar">
      Â© adam davis 2019
    </div>
  </div>


  <script>
    document.querySelector('admataz-blocks').setAttribute("containerwidth", document.body.clientWidth)
    window.addEventListener('resize', () => {
      document.querySelector('admataz-blocks').setAttribute("containerwidth", document.body.clientWidth)
    })
  </script>
</body>

</html>